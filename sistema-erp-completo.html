<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema ERP NXT - Completo</title>
    <meta name="description" content="Sistema ERP completo com todos os m√≥dulos">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif; }
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .sidebar-transition { transition: all 0.3s ease; }
        .module-card { transition: transform 0.2s ease, box-shadow 0.2s ease; }
        .module-card:hover { transform: translateY(-2px); box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        .sidebar { background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%); }
        .sidebar-item { transition: all 0.3s ease; }
        .sidebar-item:hover { background: rgba(255,255,255,0.1); }
        .sidebar-item.active { background: rgba(255,255,255,0.2); }
        .content-area { min-height: calc(100vh - 4rem); }
        .data-table { max-height: 600px; overflow-y: auto; }
        .modal { backdrop-filter: blur(10px); }
        .form-section { display: none; }
        .form-section.active { display: block; }
        .loading { animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .status-badge { padding: 0.25rem 0.75rem; border-radius: 9999px; font-size: 0.875rem; font-weight: 500; }
        .status-active { background: #dcfce7; color: #166534; }
        .status-inactive { background: #fee2e2; color: #991b1b; }
        .status-pending { background: #fef3c7; color: #92400e; }
        .chart-container { position: relative; height: 300px; }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="bg-white shadow-sm border-b">
        <div class="flex justify-between items-center px-6 py-4">
            <div class="flex items-center space-x-4">
                <button id="sidebarToggle" class="lg:hidden p-2 rounded hover:bg-gray-100">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="flex items-center space-x-3">
                    <div class="gradient-bg w-8 h-8 rounded-lg flex items-center justify-center">
                        <i class="fas fa-cube text-white text-sm"></i>
                    </div>
                    <h1 class="text-xl font-bold text-gray-900">Sistema ERP NXT</h1>
                </div>
            </div>
            <div class="flex items-center space-x-4">
                <div class="relative">
                    <input type="text" id="globalSearch" placeholder="Pesquisar..." 
                           class="w-64 pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                </div>
                <div class="flex items-center space-x-2">
                    <span id="environmentStatus" class="text-sm font-semibold text-green-600">‚úÖ Online</span>
                    <div class="relative">
                        <button id="userMenu" class="flex items-center space-x-2 p-2 rounded-lg hover:bg-gray-100">
                            <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center">
                                <i class="fas fa-user text-white text-sm"></i>
                            </div>
                            <span class="text-sm font-medium" data-user-name>Admin</span>
                            <i class="fas fa-chevron-down text-xs"></i>
                        </button>
                        <div id="userDropdown" class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border hidden">
                            <div class="py-1">
                                <button class="block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                                    <i class="fas fa-user mr-2"></i>Perfil
                                </button>
                                <button class="block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                                    <i class="fas fa-cog mr-2"></i>Configura√ß√µes
                                </button>
                                <hr class="my-1">
                                <button onclick="logout()" class="block w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50">
                                    <i class="fas fa-sign-out-alt mr-2"></i>Sair
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <div class="flex">
        <!-- Sidebar -->
        <aside id="sidebar" class="sidebar text-white w-64 fixed h-full z-20 lg:relative lg:z-0 sidebar-transition">
            <div class="p-6">
                <nav class="space-y-2">
                    <a href="#dashboard" class="sidebar-item active block px-4 py-3 rounded-lg text-sm font-medium">
                        <i class="fas fa-tachometer-alt mr-3"></i>Dashboard
                    </a>
                    <a href="#cad" class="sidebar-item block px-4 py-3 rounded-lg text-sm font-medium">
                        <i class="fas fa-address-book mr-3"></i>CAD - Cadastros
                    </a>
                    <a href="#vnd" class="sidebar-item block px-4 py-3 rounded-lg text-sm font-medium">
                        <i class="fas fa-shopping-cart mr-3"></i>VND - Vendas
                    </a>
                    <a href="#cmp" class="sidebar-item block px-4 py-3 rounded-lg text-sm font-medium">
                        <i class="fas fa-shopping-basket mr-3"></i>CMP - Compras
                    </a>
                    <a href="#est" class="sidebar-item block px-4 py-3 rounded-lg text-sm font-medium">
                        <i class="fas fa-boxes mr-3"></i>EST - Estoque
                    </a>
                    <a href="#fis" class="sidebar-item block px-4 py-3 rounded-lg text-sm font-medium">
                        <i class="fas fa-file-invoice mr-3"></i>FIS - Fiscal
                    </a>
                    <a href="#imp" class="sidebar-item block px-4 py-3 rounded-lg text-sm font-medium">
                        <i class="fas fa-ship mr-3"></i>IMP - Importa√ß√£o
                    </a>
                    <a href="#prd" class="sidebar-item block px-4 py-3 rounded-lg text-sm font-medium">
                        <i class="fas fa-industry mr-3"></i>PRD - Produ√ß√£o
                    </a>
                    <a href="#log" class="sidebar-item block px-4 py-3 rounded-lg text-sm font-medium">
                        <i class="fas fa-truck mr-3"></i>LOG - Log√≠stica
                    </a>
                    <a href="#loc" class="sidebar-item block px-4 py-3 rounded-lg text-sm font-medium">
                        <i class="fas fa-map-marker-alt mr-3"></i>LOC - Loca√ß√£o
                    </a>
                    <a href="#pro" class="sidebar-item block px-4 py-3 rounded-lg text-sm font-medium">
                        <i class="fas fa-project-diagram mr-3"></i>PRO - Projetos
                    </a>
                    <a href="#spt" class="sidebar-item block px-4 py-3 rounded-lg text-sm font-medium">
                        <i class="fas fa-headset mr-3"></i>SPT - Suporte
                    </a>
                    <a href="#whk" class="sidebar-item block px-4 py-3 rounded-lg text-sm font-medium">
                        <i class="fas fa-webhook mr-3"></i>WHK - Webhooks
                    </a>
                </nav>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 content-area">
            <!-- Dashboard Section -->
            <div id="dashboard-section" class="form-section active p-6">
                <div class="mb-6">
                    <h2 class="text-3xl font-bold text-gray-900 mb-2">Dashboard</h2>
                    <p class="text-gray-600">Vis√£o geral do sistema ERP</p>
                </div>

                <!-- Stats Cards -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="bg-white p-6 rounded-xl shadow-sm border">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm font-medium text-gray-600">Clientes</p>
                                <p class="text-2xl font-bold text-blue-600" id="clientsCount">0</p>
                            </div>
                            <div class="p-3 bg-blue-50 rounded-lg">
                                <i class="fas fa-users text-blue-600"></i>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm border">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm font-medium text-gray-600">Produtos</p>
                                <p class="text-2xl font-bold text-green-600" id="productsCount">0</p>
                            </div>
                            <div class="p-3 bg-green-50 rounded-lg">
                                <i class="fas fa-box text-green-600"></i>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm border">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm font-medium text-gray-600">Vendas</p>
                                <p class="text-2xl font-bold text-purple-600" id="salesCount">0</p>
                            </div>
                            <div class="p-3 bg-purple-50 rounded-lg">
                                <i class="fas fa-chart-line text-purple-600"></i>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm border">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm font-medium text-gray-600">Faturamento</p>
                                <p class="text-2xl font-bold text-orange-600" id="revenueCount">R$ 0</p>
                            </div>
                            <div class="p-3 bg-orange-50 rounded-lg">
                                <i class="fas fa-dollar-sign text-orange-600"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Charts -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                    <div class="bg-white p-6 rounded-xl shadow-sm border">
                        <h3 class="text-lg font-semibold mb-4">Vendas Mensais</h3>
                        <div class="chart-container">
                            <canvas id="salesChart"></canvas>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm border">
                        <h3 class="text-lg font-semibold mb-4">Produtos por Categoria</h3>
                        <div class="chart-container">
                            <canvas id="productsChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Recent Activity -->
                <div class="bg-white p-6 rounded-xl shadow-sm border">
                    <h3 class="text-lg font-semibold mb-4">Atividades Recentes</h3>
                    <div id="recentActivity" class="space-y-4">
                        <!-- Activities will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- CAD Section -->
            <div id="cad-section" class="form-section p-6">
                <div class="mb-6">
                    <h2 class="text-3xl font-bold text-gray-900 mb-2">CAD - Cadastros</h2>
                    <p class="text-gray-600">Gest√£o de clientes, produtos e fornecedores</p>
                </div>

                <!-- Sub-navigation -->
                <div class="bg-white p-4 rounded-xl shadow-sm border mb-6">
                    <div class="flex space-x-4">
                        <button id="cadClientsBtn" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600">
                            <i class="fas fa-users mr-2"></i>Clientes
                        </button>
                        <button id="cadProductsBtn" class="px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200">
                            <i class="fas fa-box mr-2"></i>Produtos
                        </button>
                        <button id="cadSuppliersBtn" class="px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200">
                            <i class="fas fa-truck mr-2"></i>Fornecedores
                        </button>
                    </div>
                </div>

                <!-- Clients Management -->
                <div id="cadClientsContent" class="cad-content active">
                    <div class="bg-white p-6 rounded-xl shadow-sm border">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-xl font-semibold">Clientes</h3>
                            <button id="addClientBtn" class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600">
                                <i class="fas fa-plus mr-2"></i>Novo Cliente
                            </button>
                        </div>
                        <div class="data-table">
                            <table id="clientsTable" class="w-full">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nome</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Email</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Telefone</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">A√ß√µes</th>
                                    </tr>
                                </thead>
                                <tbody id="clientsTableBody" class="bg-white divide-y divide-gray-200">
                                    <!-- Client rows will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Products Management -->
                <div id="cadProductsContent" class="cad-content">
                    <div class="bg-white p-6 rounded-xl shadow-sm border">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-xl font-semibold">Produtos</h3>
                            <button id="addProductBtn" class="bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600">
                                <i class="fas fa-plus mr-2"></i>Novo Produto
                            </button>
                        </div>
                        <div class="data-table">
                            <table id="productsTable" class="w-full">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">C√≥digo</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Descri√ß√£o</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Categoria</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Pre√ßo</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Estoque</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">A√ß√µes</th>
                                    </tr>
                                </thead>
                                <tbody id="productsTableBody" class="bg-white divide-y divide-gray-200">
                                    <!-- Product rows will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Suppliers Management -->
                <div id="cadSuppliersContent" class="cad-content">
                    <div class="bg-white p-6 rounded-xl shadow-sm border">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-xl font-semibold">Fornecedores</h3>
                            <button id="addSupplierBtn" class="bg-purple-500 text-white px-4 py-2 rounded-lg hover:bg-purple-600">
                                <i class="fas fa-plus mr-2"></i>Novo Fornecedor
                            </button>
                        </div>
                        <div class="data-table">
                            <table id="suppliersTable" class="w-full">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nome</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">CNPJ</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Contato</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">A√ß√µes</th>
                                    </tr>
                                </thead>
                                <tbody id="suppliersTableBody" class="bg-white divide-y divide-gray-200">
                                    <!-- Supplier rows will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VND Section -->
            <div id="vnd-section" class="form-section p-6">
                <div class="mb-6">
                    <h2 class="text-3xl font-bold text-gray-900 mb-2">VND - Vendas</h2>
                    <p class="text-gray-600">Gest√£o de vendas, pedidos e CRM</p>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- Sales Pipeline -->
                    <div class="lg:col-span-2 bg-white p-6 rounded-xl shadow-sm border">
                        <h3 class="text-xl font-semibold mb-4">Pipeline de Vendas</h3>
                        <div id="salesPipeline" class="grid grid-cols-1 md:grid-cols-4 gap-4">
                            <div class="bg-blue-50 p-4 rounded-lg">
                                <h4 class="font-medium text-blue-900">Leads</h4>
                                <p class="text-2xl font-bold text-blue-600" id="leadsCount">0</p>
                            </div>
                            <div class="bg-yellow-50 p-4 rounded-lg">
                                <h4 class="font-medium text-yellow-900">Propostas</h4>
                                <p class="text-2xl font-bold text-yellow-600" id="proposalsCount">0</p>
                            </div>
                            <div class="bg-green-50 p-4 rounded-lg">
                                <h4 class="font-medium text-green-900">Negocia√ß√£o</h4>
                                <p class="text-2xl font-bold text-green-600" id="negotiationCount">0</p>
                            </div>
                            <div class="bg-purple-50 p-4 rounded-lg">
                                <h4 class="font-medium text-purple-900">Fechadas</h4>
                                <p class="text-2xl font-bold text-purple-600" id="closedCount">0</p>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="bg-white p-6 rounded-xl shadow-sm border">
                        <h3 class="text-xl font-semibold mb-4">A√ß√µes R√°pidas</h3>
                        <div class="space-y-3">
                            <button class="w-full bg-blue-500 text-white py-3 rounded-lg hover:bg-blue-600">
                                <i class="fas fa-plus mr-2"></i>Novo Pedido
                            </button>
                            <button class="w-full bg-green-500 text-white py-3 rounded-lg hover:bg-green-600">
                                <i class="fas fa-file-invoice mr-2"></i>Gerar Proposta
                            </button>
                            <button class="w-full bg-purple-500 text-white py-3 rounded-lg hover:bg-purple-600">
                                <i class="fas fa-chart-bar mr-2"></i>Relat√≥rio Vendas
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- EST Section -->
            <div id="est-section" class="form-section p-6">
                <div class="mb-6">
                    <h2 class="text-3xl font-bold text-gray-900 mb-2">EST - Estoque</h2>
                    <p class="text-gray-600">Controle de estoque e movimenta√ß√µes</p>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- Stock Levels -->
                    <div class="lg:col-span-2 bg-white p-6 rounded-xl shadow-sm border">
                        <h3 class="text-xl font-semibold mb-4">N√≠veis de Estoque</h3>
                        <div id="stockLevels" class="space-y-4">
                            <div class="flex items-center justify-between p-3 bg-red-50 rounded-lg">
                                <div>
                                    <p class="font-medium text-red-900">Produtos em Falta</p>
                                    <p class="text-sm text-red-600">Necessitam reposi√ß√£o urgente</p>
                                </div>
                                <span class="text-2xl font-bold text-red-600" id="outOfStockCount">0</span>
                            </div>
                            <div class="flex items-center justify-between p-3 bg-yellow-50 rounded-lg">
                                <div>
                                    <p class="font-medium text-yellow-900">Estoque Baixo</p>
                                    <p class="text-sm text-yellow-600">Abaixo do n√≠vel m√≠nimo</p>
                                </div>
                                <span class="text-2xl font-bold text-yellow-600" id="lowStockCount">0</span>
                            </div>
                            <div class="flex items-center justify-between p-3 bg-green-50 rounded-lg">
                                <div>
                                    <p class="font-medium text-green-900">Estoque Normal</p>
                                    <p class="text-sm text-green-600">Dentro dos n√≠veis adequados</p>
                                </div>
                                <span class="text-2xl font-bold text-green-600" id="normalStockCount">0</span>
                            </div>
                        </div>
                    </div>

                    <!-- Stock Actions -->
                    <div class="bg-white p-6 rounded-xl shadow-sm border">
                        <h3 class="text-xl font-semibold mb-4">Movimenta√ß√µes</h3>
                        <div class="space-y-3">
                            <button class="w-full bg-green-500 text-white py-3 rounded-lg hover:bg-green-600">
                                <i class="fas fa-plus mr-2"></i>Entrada
                            </button>
                            <button class="w-full bg-red-500 text-white py-3 rounded-lg hover:bg-red-600">
                                <i class="fas fa-minus mr-2"></i>Sa√≠da
                            </button>
                            <button class="w-full bg-blue-500 text-white py-3 rounded-lg hover:bg-blue-600">
                                <i class="fas fa-exchange-alt mr-2"></i>Transfer√™ncia
                            </button>
                            <button class="w-full bg-purple-500 text-white py-3 rounded-lg hover:bg-purple-600">
                                <i class="fas fa-inventory mr-2"></i>Invent√°rio
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- IMP Section -->
            <div id="imp-section" class="form-section p-6">
                <div class="mb-6">
                    <h2 class="text-3xl font-bold text-gray-900 mb-2">IMP - Importa√ß√£o</h2>
                    <p class="text-gray-600">Gest√£o de importa√ß√µes e processos</p>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Import Processes -->
                    <div class="bg-white p-6 rounded-xl shadow-sm border">
                        <h3 class="text-xl font-semibold mb-4">Processos de Importa√ß√£o</h3>
                        <div id="importProcesses" class="space-y-4">
                            <!-- Import processes will be loaded here -->
                        </div>
                    </div>

                    <!-- Import Stats -->
                    <div class="bg-white p-6 rounded-xl shadow-sm border">
                        <h3 class="text-xl font-semibold mb-4">Estat√≠sticas</h3>
                        <div id="importStats" class="grid grid-cols-2 gap-4">
                            <div class="text-center p-4 bg-blue-50 rounded-lg">
                                <p class="text-2xl font-bold text-blue-600" id="activeProcessesCount">0</p>
                                <p class="text-sm text-blue-900">Processos Ativos</p>
                            </div>
                            <div class="text-center p-4 bg-green-50 rounded-lg">
                                <p class="text-2xl font-bold text-green-600" id="totalValueCount">R$ 0</p>
                                <p class="text-sm text-green-900">Valor Total</p>
                            </div>
                            <div class="text-center p-4 bg-yellow-50 rounded-lg">
                                <p class="text-2xl font-bold text-yellow-600" id="pendingProcessesCount">0</p>
                                <p class="text-sm text-yellow-900">Aguardando</p>
                            </div>
                            <div class="text-center p-4 bg-purple-50 rounded-lg">
                                <p class="text-2xl font-bold text-purple-600" id="averageDaysCount">0</p>
                                <p class="text-sm text-purple-900">Dias M√©dios</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Other sections would continue here... -->
        </main>
    </div>

    <!-- Modals -->
    <div id="clientModal" class="modal fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4">
        <div class="bg-white rounded-xl max-w-2xl w-full max-h-screen overflow-y-auto">
            <div class="p-6 border-b">
                <h3 class="text-xl font-semibold">Novo Cliente</h3>
            </div>
            <form id="clientForm" class="p-6 space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Nome/Raz√£o Social</label>
                        <input type="text" name="nome" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">CPF/CNPJ</label>
                        <input type="text" name="cpf_cnpj" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                        <input type="email" name="email" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Telefone</label>
                        <input type="tel" name="telefone" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                </div>
                <div class="flex justify-end space-x-4 pt-4">
                    <button type="button" id="cancelClientBtn" class="px-6 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200">
                        Cancelar
                    </button>
                    <button type="submit" class="px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600">
                        Salvar
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script src="./api-client.js"></script>
    <script>
        // System configuration
        const config = {
            apiUrl: window.location.hostname === 'localhost' ? 'http://localhost:3001' : 'https://erp-api-clean-r88y1fdz9-nxt-9032fd74.vercel.app',
            refreshInterval: 30000,
            environment: window.location.hostname === 'localhost' ? 'development' : 'production'
        };

        // Global state
        let currentSection = 'dashboard';
        let currentCadTab = 'clients';
        let clientsData = [];
        let productsData = [];
        let suppliersData = [];
        let dashboardData = {};

        // Initialize the system
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ DOM Content Loaded - Starting system initialization');
            checkAuthentication();
            initializeSystem();
            setupEventListeners();
            
            // Ensure dashboard section is properly displayed and load its data
            console.log('üì± Showing dashboard section');
            showSection('dashboard');
        });

        function checkAuthentication() {
            const authToken = localStorage.getItem('auth_token');
            const userData = localStorage.getItem('user_data');
            
            if (!authToken || !userData) {
                // Usu√°rio n√£o autenticado, redirecionar para login
                window.location.href = './login-direto.html';
                return;
            }
            
            try {
                const user = JSON.parse(userData);
                // Atualizar nome do usu√°rio na interface
                const userNameElements = document.querySelectorAll('[data-user-name]');
                userNameElements.forEach(el => {
                    el.textContent = user.first_name || 'Admin';
                });
                
                console.log('‚úÖ Usu√°rio autenticado:', user.first_name);
            } catch (error) {
                console.error('Erro ao ler dados do usu√°rio:', error);
                // Dados corrompidos, redirecionar para login
                localStorage.clear();
                window.location.href = './login-direto.html';
            }
        }

        function initializeSystem() {
            console.log('üöÄ Sistema ERP NXT inicializado');
            console.log('üåê Ambiente:', config.environment);
            console.log('üì° API URL:', config.apiUrl);
            
            // Update environment status
            document.getElementById('environmentStatus').textContent = 
                config.environment === 'development' ? 'üíª Desenvolvimento' : 'üöÄ Produ√ß√£o';
        }

        function setupEventListeners() {
            // Sidebar navigation
            document.querySelectorAll('.sidebar-item').forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    const section = this.getAttribute('href').substring(1);
                    showSection(section);
                });
            });

            // Sidebar toggle
            document.getElementById('sidebarToggle').addEventListener('click', function() {
                const sidebar = document.getElementById('sidebar');
                sidebar.classList.toggle('-translate-x-full');
            });

            // CAD sub-navigation
            document.getElementById('cadClientsBtn').addEventListener('click', () => showCadTab('clients'));
            document.getElementById('cadProductsBtn').addEventListener('click', () => showCadTab('products'));
            document.getElementById('cadSuppliersBtn').addEventListener('click', () => showCadTab('suppliers'));

            // User menu dropdown
            document.getElementById('userMenu').addEventListener('click', function() {
                const dropdown = document.getElementById('userDropdown');
                dropdown.classList.toggle('hidden');
            });

            // Close dropdown when clicking outside
            document.addEventListener('click', function(e) {
                const userMenu = document.getElementById('userMenu');
                const dropdown = document.getElementById('userDropdown');
                if (!userMenu.contains(e.target)) {
                    dropdown.classList.add('hidden');
                }
            });

            // Modal controls
            document.getElementById('addClientBtn').addEventListener('click', () => openModal('clientModal'));
            document.getElementById('cancelClientBtn').addEventListener('click', () => closeModal('clientModal'));

            // Form submissions
            document.getElementById('clientForm').addEventListener('submit', handleClientSubmit);
        }

        function showSection(section) {
            console.log(`üîÑ Switching to section: ${section}`);
            
            // Hide all sections
            document.querySelectorAll('.form-section').forEach(sec => {
                sec.classList.remove('active');
            });

            // Show selected section
            const targetSection = document.getElementById(section + '-section');
            if (!targetSection) {
                console.error(`‚ùå Section ${section}-section not found`);
                return;
            }
            targetSection.classList.add('active');
            console.log(`‚úÖ Section ${section}-section is now active`);

            // Update sidebar active state
            document.querySelectorAll('.sidebar-item').forEach(item => {
                item.classList.remove('active');
            });
            const sidebarLink = document.querySelector(`[href="#${section}"]`);
            if (sidebarLink) {
                sidebarLink.classList.add('active');
            }

            currentSection = section;

            // Load section data
            switch(section) {
                case 'dashboard':
                    loadDashboardData();
                    break;
                case 'cad':
                    loadCadData();
                    break;
                case 'vnd':
                    loadVendasData();
                    break;
                case 'est':
                    loadEstoqueData();
                    break;
                case 'imp':
                    loadImportacaoData();
                    break;
                // Add other sections as needed
            }
        }

        function showCadTab(tab) {
            // Hide all CAD content
            document.querySelectorAll('.cad-content').forEach(content => {
                content.classList.remove('active');
            });

            // Show selected content
            document.getElementById(`cad${tab.charAt(0).toUpperCase() + tab.slice(1)}Content`).classList.add('active');

            // Update button states
            document.querySelectorAll('[id^="cad"][id$="Btn"]').forEach(btn => {
                btn.classList.remove('bg-blue-500', 'text-white');
                btn.classList.add('bg-gray-100', 'text-gray-700');
            });

            document.getElementById(`cad${tab.charAt(0).toUpperCase() + tab.slice(1)}Btn`).classList.remove('bg-gray-100', 'text-gray-700');
            document.getElementById(`cad${tab.charAt(0).toUpperCase() + tab.slice(1)}Btn`).classList.add('bg-blue-500', 'text-white');

            currentCadTab = tab;

            // Load tab data
            switch(tab) {
                case 'clients':
                    loadClientsData();
                    break;
                case 'products':
                    loadProductsData();
                    break;
                case 'suppliers':
                    loadSuppliersData();
                    break;
            }
        }

        async function loadDashboardData() {
            try {
                console.log('üöÄ loadDashboardData started');
                showLoading('dashboard-section');
                
                console.log('üì° Fetching dashboard stats...');
                const stats = await fetchDashboardStats();
                console.log('üìä Stats received:', stats);
                
                console.log('üîÑ Updating dashboard stats...');
                updateDashboardStats(stats);
                
                console.log('üì° Fetching recent activities...');
                const activities = await fetchRecentActivities();
                console.log('üìã Activities received:', activities);
                
                console.log('üîÑ Updating recent activities...');
                updateRecentActivities(activities);
                
                console.log('üìà Initializing charts...');
                await initializeCharts();
                
                hideLoading('dashboard-section');
                console.log('‚úÖ loadDashboardData completed successfully');
            } catch (error) {
                console.error('‚ùå Erro ao carregar dados do dashboard:', error);
                console.error('‚ùå Error stack:', error.stack);
                hideLoading('dashboard-section');
                showError('dashboard-section', `Erro ao carregar dados: ${error.message}`);
            }
        }

        async function fetchDashboardStats() {
            const response = await window.erpApi.getDashboardStats();
            return response.data;
        }

        async function fetchRecentActivities() {
            const response = await window.erpApi.getDashboardActivities();
            return response.data;
        }

        function updateDashboardStats(stats) {
            try {
                console.log('üîç updateDashboardStats called with:', stats);
                
                // Use the correct property names from API response
                const clientsCount = stats.totalClientes || stats.detalhes?.clientes || 0;
                const productsCount = stats.detalhes?.produtos || 0;
                const salesCount = stats.totalVendas || stats.detalhes?.vendas || 0;
                const revenue = stats.faturamentoMes || 0;
                
                console.log('üìä Extracted values:', { clientsCount, productsCount, salesCount, revenue });
                
                // Check if elements exist before updating
                const clientsElement = document.getElementById('clientsCount');
                const productsElement = document.getElementById('productsCount');
                const salesElement = document.getElementById('salesCount');
                const revenueElement = document.getElementById('revenueCount');
                
                console.log('üîç Elements found:', {
                    clientsElement: !!clientsElement,
                    productsElement: !!productsElement,
                    salesElement: !!salesElement,
                    revenueElement: !!revenueElement
                });
                
                if (!clientsElement) {
                    console.error('‚ùå clientsCount element not found');
                    return;
                }
                if (!productsElement) {
                    console.error('‚ùå productsCount element not found');
                    return;
                }
                if (!salesElement) {
                    console.error('‚ùå salesCount element not found');
                    return;
                }
                if (!revenueElement) {
                    console.error('‚ùå revenueCount element not found');
                    return;
                }
                
                // Update elements safely
                clientsElement.textContent = clientsCount.toLocaleString();
                productsElement.textContent = productsCount.toLocaleString();
                salesElement.textContent = salesCount.toLocaleString();
                revenueElement.textContent = `R$ ${revenue.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
                
                console.log('‚úÖ Dashboard stats updated successfully');
                
            } catch (error) {
                console.error('‚ùå Error in updateDashboardStats:', error);
                throw error;
            }
        }

        function updateRecentActivities(activities) {
            const container = document.getElementById('recentActivity');
            container.innerHTML = activities.map(activity => `
                <div class="flex items-center space-x-4 p-3 bg-gray-50 rounded-lg">
                    <div class="flex-shrink-0">
                        <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center">
                            <i class="fas fa-${getActivityIcon(activity.type)} text-white text-sm"></i>
                        </div>
                    </div>
                    <div class="flex-1">
                        <p class="text-sm font-medium text-gray-900">${activity.action}</p>
                        <p class="text-sm text-gray-500">${activity.description}</p>
                    </div>
                    <div class="text-xs text-gray-400">${activity.time}</div>
                </div>
            `).join('');
        }

        function getActivityIcon(type) {
            const icons = {
                client: 'user',
                sale: 'shopping-cart',
                product: 'box',
                import: 'ship'
            };
            return icons[type] || 'info';
        }

        async function initializeCharts() {
            try {
                const authToken = localStorage.getItem('auth_token');
                
                // Get sales chart data
                const salesResponse = await fetch(`${config.apiUrl}/dashboard/charts/sales`, {
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                const salesData = salesResponse.ok ? await salesResponse.json() : null;
                
                // Get products chart data
                const productsResponse = await fetch(`${config.apiUrl}/dashboard/charts/products`, {
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                const productsData = productsResponse.ok ? await productsResponse.json() : null;
                
                // Sales Chart
                const salesCtx = document.getElementById('salesChart').getContext('2d');
                new Chart(salesCtx, {
                    type: 'line',
                    data: {
                        labels: salesData?.data?.labels || ['Sem dados'],
                        datasets: [{
                            label: 'Vendas',
                            data: salesData?.data?.values || [0],
                            borderColor: 'rgb(59, 130, 246)',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });

                // Products Chart
                const productsCtx = document.getElementById('productsChart').getContext('2d');
                new Chart(productsCtx, {
                    type: 'doughnut',
                    data: {
                        labels: productsData?.data?.labels || ['Sem dados'],
                        datasets: [{
                            data: productsData?.data?.values || [1],
                            backgroundColor: productsData?.data?.colors || ['rgb(156, 163, 175)']
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }
                });
                
            } catch (error) {
                console.error('Erro ao carregar dados dos gr√°ficos:', error);
                // Show empty charts with error message
                showChartError();
            }
        }


        function loadCadData() {
            if (currentCadTab === 'clients') {
                loadClientsData();
            } else if (currentCadTab === 'products') {
                loadProductsData();
            } else if (currentCadTab === 'suppliers') {
                loadSuppliersData();
            }
        }

        async function loadClientsData() {
            try {
                showLoading('clientsTable');
                
                const response = await window.erpApi.getClients();
                const clients = response.data || [];
                
                const tbody = document.getElementById('clientsTableBody');
                tbody.innerHTML = clients.map(client => `
                    <tr>
                        <td class="px-4 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${client.name || client.nome}</td>
                        <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-500">${client.email}</td>
                        <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-500">${client.phone || client.telefone}</td>
                        <td class="px-4 py-4 whitespace-nowrap">
                            <span class="status-badge ${client.status === 'active' || client.ativo ? 'status-active' : 'status-inactive'}">
                                ${client.status === 'active' || client.ativo ? 'Ativo' : 'Inativo'}
                            </span>
                        </td>
                        <td class="px-4 py-4 whitespace-nowrap text-sm font-medium">
                            <button class="text-blue-600 hover:text-blue-900 mr-2" onclick="editClient(${client.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="text-red-600 hover:text-red-900" onclick="deleteClient(${client.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `).join('');
                
                hideLoading('clientsTable');
            } catch (error) {
                console.error('Erro ao carregar clientes:', error);
                hideLoading('clientsTable');
                showError('clientsTable', `Erro ao carregar clientes: ${error.message}`);
            }
        }

        async function loadProductsData() {
            try {
                showLoading('productsTable');
                
                const response = await window.erpApi.getProducts();
                const products = response.data || [];
                
                const tbody = document.getElementById('productsTableBody');
                tbody.innerHTML = products.map(product => `
                    <tr>
                        <td class="px-4 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${product.code || product.codigo}</td>
                        <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-500">${product.description || product.descricao}</td>
                        <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-500">${product.category || product.categoria}</td>
                        <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-500">R$ ${(product.price || product.preco || 0).toFixed(2)}</td>
                        <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-500">${product.stock || product.estoque || 0}</td>
                        <td class="px-4 py-4 whitespace-nowrap text-sm font-medium">
                            <button class="text-blue-600 hover:text-blue-900 mr-2" onclick="editProduct(${product.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="text-red-600 hover:text-red-900" onclick="deleteProduct(${product.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `).join('');
                
                hideLoading('productsTable');
            } catch (error) {
                console.error('Erro ao carregar produtos:', error);
                hideLoading('productsTable');
                showError('productsTable', `Erro ao carregar produtos: ${error.message}`);
            }
        }

        async function loadSuppliersData() {
            try {
                showLoading('suppliersTable');
                
                const response = await window.erpApi.getSuppliers();
                const suppliers = response.data || [];
                
                const tbody = document.getElementById('suppliersTableBody');
                tbody.innerHTML = suppliers.map(supplier => `
                    <tr>
                        <td class="px-4 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${supplier.name || supplier.nome}</td>
                        <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-500">${supplier.cnpj}</td>
                        <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-500">${supplier.contact || supplier.contato}</td>
                        <td class="px-4 py-4 whitespace-nowrap">
                            <span class="status-badge ${supplier.status === 'active' || supplier.ativo ? 'status-active' : 'status-inactive'}">
                                ${supplier.status === 'active' || supplier.ativo ? 'Ativo' : 'Inativo'}
                            </span>
                        </td>
                        <td class="px-4 py-4 whitespace-nowrap text-sm font-medium">
                            <button class="text-blue-600 hover:text-blue-900 mr-2" onclick="editSupplier(${supplier.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="text-red-600 hover:text-red-900" onclick="deleteSupplier(${supplier.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `).join('');
                
                hideLoading('suppliersTable');
            } catch (error) {
                console.error('Erro ao carregar fornecedores:', error);
                hideLoading('suppliersTable');
                showError('suppliersTable', `Erro ao carregar fornecedores: ${error.message}`);
            }
        }

        function openModal(modalId) {
            document.getElementById(modalId).classList.remove('hidden');
            document.getElementById(modalId).classList.add('flex');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.add('hidden');
            document.getElementById(modalId).classList.remove('flex');
        }

        async function handleClientSubmit(e) {
            e.preventDefault();
            
            try {
                const formData = new FormData(e.target);
                const clientData = {
                    name: formData.get('nome'),
                    cpf_cnpj: formData.get('cpf_cnpj'),
                    email: formData.get('email'),
                    phone: formData.get('telefone')
                };

                const response = await window.erpApi.createClient(clientData);
                
                console.log('Cliente salvo com sucesso:', response);
                
                // Close modal and refresh data
                closeModal('clientModal');
                await loadClientsData();
                
                // Reset form
                e.target.reset();
                
            } catch (error) {
                console.error('Erro ao salvar cliente:', error);
                alert(`Erro ao salvar cliente: ${error.message}`);
            }
        }

        function logout() {
            // Confirmar logout
            if (confirm('Tem certeza que deseja sair do sistema?')) {
                // Usar API client para logout
                window.erpApi.logout().then(() => {
                    window.location.href = './login-direto.html';
                }).catch(() => {
                    // Mesmo se o logout falhar, limpar localmente
                    window.erpApi.clearAuth();
                    window.location.href = './login-direto.html';
                });
            }
        }

        // Fun√ß√£o para mostrar erros de carregamento
        function showError(message) {
            const errorHtml = `
                <div class="bg-red-50 border border-red-200 rounded-lg p-4 m-4">
                    <div class="flex">
                        <i class="fas fa-exclamation-triangle text-red-400 mr-3 mt-1"></i>
                        <div>
                            <h3 class="text-red-800 font-medium">Erro de Conex√£o</h3>
                            <p class="text-red-700 text-sm mt-1">${message}</p>
                            <button onclick="window.location.reload()" class="mt-2 bg-red-600 text-white px-4 py-2 rounded text-sm hover:bg-red-700">
                                Tentar Novamente
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            // Mostrar erro no dashboard
            const container = document.querySelector('.content-area');
            if (container) {
                container.innerHTML = errorHtml;
            }
        }

        // Fun√ß√£o para mostrar loading
        function showLoading(message = 'Carregando...') {
            const loadingHtml = `
                <div class="flex items-center justify-center p-8">
                    <div class="text-center">
                        <div class="loading inline-block w-8 h-8 border-4 border-blue-200 border-t-blue-600 rounded-full mb-4"></div>
                        <p class="text-gray-600">${message}</p>
                    </div>
                </div>
            `;
            return loadingHtml;
        }

        // Auto-refresh dashboard data
        setInterval(() => {
            if (currentSection === 'dashboard') {
                loadDashboardData();
            }
        }, config.refreshInterval);

        // Loading and error handling functions
        function showLoading(elementId) {
            const element = document.getElementById(elementId);
            if (element) {
                element.innerHTML = `
                    <div class="flex items-center justify-center p-8">
                        <div class="loading inline-block w-6 h-6 border-2 border-blue-500 border-t-transparent rounded-full mr-3"></div>
                        <span class="text-gray-600">Carregando...</span>
                    </div>
                `;
            }
        }
        
        function hideLoading(elementId) {
            // Loading is hidden when content is replaced
        }
        
        function showError(elementId, message) {
            const element = document.getElementById(elementId);
            if (element) {
                element.innerHTML = `
                    <div class="flex items-center justify-center p-8">
                        <div class="text-center">
                            <i class="fas fa-exclamation-triangle text-red-500 text-2xl mb-2"></i>
                            <p class="text-red-600 font-medium">${message}</p>
                            <button onclick="location.reload()" class="mt-3 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600">
                                Tentar novamente
                            </button>
                        </div>
                    </div>
                `;
            }
        }
        
        function showChartError() {
            const salesChart = document.getElementById('salesChart');
            const productsChart = document.getElementById('productsChart');
            
            if (salesChart) {
                salesChart.parentElement.innerHTML = `
                    <div class="flex items-center justify-center h-full">
                        <div class="text-center text-gray-500">
                            <i class="fas fa-chart-line text-2xl mb-2"></i>
                            <p>Erro ao carregar dados do gr√°fico</p>
                        </div>
                    </div>
                `;
            }
            
            if (productsChart) {
                productsChart.parentElement.innerHTML = `
                    <div class="flex items-center justify-center h-full">
                        <div class="text-center text-gray-500">
                            <i class="fas fa-chart-pie text-2xl mb-2"></i>
                            <p>Erro ao carregar dados do gr√°fico</p>
                        </div>
                    </div>
                `;
            }
        }
        
        // Client, product and supplier management functions
        function editClient(id) {
            console.log('Editando cliente:', id);
            // Implement edit functionality
        }
        
        function deleteClient(id) {
            if (confirm('Tem certeza que deseja excluir este cliente?')) {
                console.log('Excluindo cliente:', id);
                // Implement delete functionality
            }
        }
        
        function editProduct(id) {
            console.log('Editando produto:', id);
            // Implement edit functionality
        }
        
        function deleteProduct(id) {
            if (confirm('Tem certeza que deseja excluir este produto?')) {
                console.log('Excluindo produto:', id);
                // Implement delete functionality
            }
        }
        
        function editSupplier(id) {
            console.log('Editando fornecedor:', id);
            // Implement edit functionality
        }
        
        function deleteSupplier(id) {
            if (confirm('Tem certeza que deseja excluir este fornecedor?')) {
                console.log('Excluindo fornecedor:', id);
                // Implement delete functionality
            }
        }
        
        // Section data loading functions
        async function loadVendasData() {
            try {
                const authToken = localStorage.getItem('auth_token');
                const response = await fetch(`${config.apiUrl}/vnd/pipeline`, {
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    const pipeline = data.data || {};
                    
                    document.getElementById('leadsCount').textContent = pipeline.leads || 0;
                    document.getElementById('proposalsCount').textContent = pipeline.proposals || 0;
                    document.getElementById('negotiationCount').textContent = pipeline.negotiation || 0;
                    document.getElementById('closedCount').textContent = pipeline.closed || 0;
                } else {
                    showError('salesPipeline', 'Erro ao carregar dados do pipeline de vendas');
                }
            } catch (error) {
                console.error('Erro ao carregar dados de vendas:', error);
                showError('salesPipeline', `Erro ao carregar dados: ${error.message}`);
            }
        }
        
        async function loadEstoqueData() {
            try {
                const authToken = localStorage.getItem('auth_token');
                const response = await fetch(`${config.apiUrl}/est/levels`, {
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    const levels = data.data || {};
                    
                    document.getElementById('outOfStockCount').textContent = levels.out_of_stock || 0;
                    document.getElementById('lowStockCount').textContent = levels.low_stock || 0;
                    document.getElementById('normalStockCount').textContent = levels.normal_stock || 0;
                } else {
                    showError('stockLevels', 'Erro ao carregar n√≠veis de estoque');
                }
            } catch (error) {
                console.error('Erro ao carregar dados de estoque:', error);
                showError('stockLevels', `Erro ao carregar dados: ${error.message}`);
            }
        }
        
        async function loadImportacaoData() {
            try {
                const authToken = localStorage.getItem('auth_token');
                
                // Load import processes
                const processesResponse = await fetch(`${config.apiUrl}/imp/processes`, {
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                if (processesResponse.ok) {
                    const processesData = await processesResponse.json();
                    const processes = processesData.data || [];
                    
                    const processesContainer = document.getElementById('importProcesses');
                    processesContainer.innerHTML = processes.map(process => `
                        <div class="flex items-center justify-between p-3 border rounded-lg">
                            <div>
                                <p class="font-medium">${process.code || process.numero}</p>
                                <p class="text-sm text-gray-600">${process.description || process.descricao}</p>
                            </div>
                            <span class="status-badge ${getProcessStatusClass(process.status)}">
                                ${getProcessStatusText(process.status)}
                            </span>
                        </div>
                    `).join('');
                }
                
                // Load import stats
                const statsResponse = await fetch(`${config.apiUrl}/imp/stats`, {
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                if (statsResponse.ok) {
                    const statsData = await statsResponse.json();
                    const stats = statsData.data || {};
                    
                    document.getElementById('activeProcessesCount').textContent = stats.active || 0;
                    document.getElementById('totalValueCount').textContent = `R$ ${(stats.total_value || 0).toLocaleString()}`;
                    document.getElementById('pendingProcessesCount').textContent = stats.pending || 0;
                    document.getElementById('averageDaysCount').textContent = stats.average_days || 0;
                }
                
            } catch (error) {
                console.error('Erro ao carregar dados de importa√ß√£o:', error);
                showError('importProcesses', `Erro ao carregar dados: ${error.message}`);
                showError('importStats', `Erro ao carregar estat√≠sticas: ${error.message}`);
            }
        }
        
        function getProcessStatusClass(status) {
            const statusMap = {
                'active': 'status-active',
                'pending': 'status-pending',
                'inactive': 'status-inactive',
                'transit': 'status-pending',
                'cleared': 'status-active',
                'documentation': 'status-inactive'
            };
            return statusMap[status] || 'status-inactive';
        }
        
        function getProcessStatusText(status) {
            const statusMap = {
                'active': 'Ativo',
                'pending': 'Pendente',
                'inactive': 'Inativo',
                'transit': 'Em Tr√¢nsito',
                'cleared': 'Desembara√ßado',
                'documentation': 'Documenta√ß√£o'
            };
            return statusMap[status] || 'Desconhecido';
        }
        
        // Global search functionality
        document.getElementById('globalSearch').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            if (searchTerm.length >= 3) {
                // Implement global search
                console.log('Searching for:', searchTerm);
            }
        });
    </script>
</body>
</html>